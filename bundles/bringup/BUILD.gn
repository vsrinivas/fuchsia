# Copyright 2020 The Fuchsia Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

import("//build/unification/images/common_test_contents.gni")

group("tests") {
  testonly = true

  # Add the testrunner.
  deps = [ "//src/testing/runtests" ]

  deps += [
    "//src/bringup/bin/console:bootfs-test",
    "//src/bringup/bin/ptysvc:ptysvc-test-bootfs-test",
    "//src/bringup/bin/svchost:crashsvc-test-bootfs-test",
    "//src/bringup/bin/sysinfo:sysinfo-test",  # This is a package.
    "//src/bringup/tests/bootfs_test",  # This is a package.
    "//src/devices/block/bin/biotime:biotime-test-bootfs-test",
    "//src/devices/bus/lib/device-protocol-pdev/test:device-protocol-pdev-test-bootfs-test",
    "//src/devices/nand/drivers/broker/test:nand-broker-package",  # HW-required.
    "//src/devices/nand/drivers/ram-nand:ram-nand-test-bootfs-test",
    "//src/devices/sysmem/tests/sysmem:sysmem-bootfs-test",

    # The devcoordinator-namespace-test assumes the root filesystem and can't be
    # migrated as packages are given their own local filesystem.
    "//src/devices/tests/devcoordinator-namespace:devcoordinator-namespace-package",
    "//src/devices/tests/devfs:devfs-bootfs-test",
    "//src/devices/thermal/drivers/mtk-thermal:mtk-thermal-integration-test-package",  # HW-required.
    "//src/devices/usb/tests/usb:usb-package",  # HW-required.
    "//src/media/audio/drivers/intel-hda/test:intel-hda-test-package",  # HW-required.
    "//src/media/audio/drivers/intel-hda/test:pixelbook-eve-test-package",  # HW-required.
    "//src/media/audio/tools/audio-driver-ctl:test-bootfs-test",
    "//src/storage/blobfs/test:bootfs-tests",
    "//src/ui/backlight/drivers/sg-micro:sgm37603a-test-bootfs-test",
    "//src/ui/backlight/drivers/ti-lp8556:ti-lp8556-test-bootfs-test",
    "//src/ui/backlight/tests:backlight-test-bootfs-test",
    "//src/zircon/tests/entropy:entropy-bootfs-test",
    "//src/zircon/tests/events:events-bootfs-test",
    "//src/zircon/tests/exception:exception-bootfs-test",
    "//src/zircon/tests/futex-ownership:futex-ownership-bootfs-test",
    "//src/zircon/tests/handle-alias:handle-alias-bootfs-test",
    "//src/zircon/tests/job-policy:policy-bootfs-test",
    "//src/zircon/tests/kcounter:kcounter-bootfs-test",
    "//src/zircon/tests/kernel-clocks:kernel-clocks-bootfs-test",
    "//src/zircon/tests/kernel-cmdline:kernel-cmdline-bootfs-test",
    "//src/zircon/tests/processor:processor-bootfs-test",
    "//src/zircon/tests/profile:profile-bootfs-test",
    "//src/zircon/tests/property:property-bootfs-test",
    "//src/zircon/tests/register-state:register-state-bootfs-test",
    "//src/zircon/tests/status:status-bootfs-test",
    "//src/zircon/tests/thread-initial-state:thread-initial-state-bootfs-test",
    "//src/zircon/tests/thread-state:thread-state-bootfs-test",
    "//src/zircon/tests/time:time-bootfs-test",
    "//src/zircon/tests/timers:timers-bootfs-test",
    "//src/zircon/tests/vdso:vdso-base-bootfs-test",
    "//src/zircon/tests/vdso:vdso-bootfs-test",
    "//src/zircon/tests/vdso:vdso-variant-bootfs-test",
    "//src/zircon/tests/vmo:vmo-bootfs-test",
    "//zircon/system/ulib/abr/test:libabr-test-bootfs-test",
    "//zircon/system/ulib/abs_clock/test:abs_clock_test-bootfs-test",
    "//zircon/system/ulib/affine/test:affine-bootfs-test",
    "//zircon/system/ulib/async-loop/test:async-loop-bootfs-test",
    "//zircon/system/ulib/async-testing/test:async-testing-bootfs-test",
    "//zircon/system/ulib/async/test:async-bootfs-test",
    "//zircon/system/ulib/backtrace-request/test:backtrace-request-bootfs-test",
    "//zircon/system/ulib/backtrace-request/test:backtrace-request-integration-bootfs-test",
    "//zircon/system/ulib/bitmap/test:bitmap-bootfs-test",
    "//zircon/system/ulib/block-client/test:block-client-unit-bootfs-test",
    "//zircon/system/ulib/c/test:atexit-bootfs-test",
    "//zircon/system/ulib/c/test:debugdata-bootfs-test",
    "//zircon/system/ulib/c/test:default-stack-size-default-bootfs-test",
    "//zircon/system/ulib/c/test:default-stack-size-phdr-bootfs-test",
    "//zircon/system/ulib/c/test:posix-clocks-bootfs-test",
    "//zircon/system/ulib/c/test/sanitizer:sanitizer-utils-bootfs-test",
    "//zircon/system/ulib/chromeos-disk-setup/test:chromeos-disk-setup-bootfs-test",
    "//zircon/system/ulib/closure-queue/test:closure-queue-bootfs-test",
    "//zircon/system/ulib/cobalt-client/test:cobalt-client-unit-bootfs-test",
    "//zircon/system/ulib/debugdata/test:debugdata-bootfs-test",
    "//zircon/system/ulib/digest/test:digest-bootfs-test",
    "//zircon/system/ulib/disk_inspector/test:disk_inspector_unit-bootfs-test",
    "//zircon/system/ulib/driver-unit-test/test:logger-unit-bootfs-test",
    "//zircon/system/ulib/elf-search/test:elf-search-bootfs-test",
    "//zircon/system/ulib/fbl/test:fbl-bootfs-test",
    "//zircon/system/ulib/fdio-caller/test:fdio-caller-bootfs-test",
    "//zircon/system/ulib/ffl/test:ffl-bootfs-test",
    "//zircon/system/ulib/fidl-async/test:fidl-async-test-bootfs-test",
    "//zircon/system/ulib/fit/test:fit-bootfs-test",
    "//zircon/system/ulib/fit/test:fit-unittest-bootfs-test",
    "//zircon/system/ulib/framebuffer/test:framebuffer-test-bootfs-test",
    "//zircon/system/ulib/fs-pty/test:libfs-pty-test-bootfs-test",
    "//zircon/system/ulib/fs/journal/test:journal-unit-bootfs-test",
    "//zircon/system/ulib/fs/metrics/test:metrics-cobalt-bootfs-test",
    "//zircon/system/ulib/fs/metrics/test:metrics-composite-latency-event-bootfs-test",
    "//zircon/system/ulib/fs/metrics/test:metrics-inspect-bootfs-test",
    "//zircon/system/ulib/fs/test:fs-connection-bootfs-test",
    "//zircon/system/ulib/fs/test:fs-vnode-bootfs-test",
    "//zircon/system/ulib/fs/test_support/test:fs_test_support-bootfs-test",
    "//zircon/system/ulib/fs/transaction/test:fs-transaction-bootfs-test",
    "//zircon/system/ulib/fs/watchdog/test:watchdog-unit-bootfs-test",
    "//zircon/system/ulib/ftl/test:ftl_test-bootfs-test",
    "//zircon/system/ulib/fvm/test:fvm-unit-bootfs-test",
    "//zircon/system/ulib/fzl/test:fzl-bootfs-test",
    "//zircon/system/ulib/fzl/test:fzl-zxtest-bootfs-test",
    "//zircon/system/ulib/gpt/test:gpt-unit-bootfs-test",
    "//zircon/system/ulib/hwreg/test:libhwreg-bootfs-test",
    "//zircon/system/ulib/hwreg/test:libhwreg-i2c-bootfs-test",
    "//zircon/system/ulib/id_allocator/test:id_allocator-test-bootfs-test",
    "//zircon/system/ulib/image-format/test:image-format-test-bootfs-test",
    "//zircon/system/ulib/inet6/test:inet6-test-bootfs-test",
    "//zircon/system/ulib/intel-hda/test:intel-hda-utils-test-bootfs-test",
    "//zircon/system/ulib/io-scheduler/test:io-scheduler-test-bootfs-test",
    "//zircon/system/ulib/kernel-mexec/test:kernel-mexec-test-bootfs-test",
    "//zircon/system/ulib/ktrace/test:ktrace-test-bootfs-test",
    "//zircon/system/ulib/launchpad/test:launchpad-bootfs-test",
    "//zircon/system/ulib/lazy_init/test:lazy_init-test-bootfs-test",
    "//zircon/system/ulib/lockdep/test:lockdep-test-bootfs-test",
    "//zircon/system/ulib/memfs/test:memfs-tests-bootfs-test",
    "//zircon/system/ulib/minfs/allocator/test:minfs-allocator-unit-bootfs-test",
    "//zircon/system/ulib/minfs/test:minfs-integration-bootfs-test",
    "//zircon/system/ulib/minfs/test:minfs-power-bootfs-test",
    "//zircon/system/ulib/minfs/test:minfs-unit-bootfs-test",
    "//zircon/system/ulib/mipi-dsi/test:mipidsi-bootfs-test",
    "//zircon/system/ulib/mmio-ptr/test:mmio-ptr-unittest-bootfs-test",
    "//zircon/system/ulib/mock-function/test:mock-function-test-bootfs-test",
    "//zircon/system/ulib/perftest/test:perftest-bootfs-test",
    "//zircon/system/ulib/pretty/test:pretty-test-bootfs-test",
    "//zircon/system/ulib/ram-crashlog/test:ram-crashlog-bootfs-test",
    "//zircon/system/ulib/range/test:range-bootfs-test",
    "//zircon/system/ulib/refcount/test:refcount-test-bootfs-test",
    "//zircon/system/ulib/region-alloc/test:region-alloc-bootfs-test",
    "//zircon/system/ulib/runtests-utils/test:service-proxy-dir-bootfs-test",
    "//zircon/system/ulib/simplehid/test:simplehid-bootfs-test",
    "//zircon/system/ulib/smbios/test:smbios-test-bootfs-test",
    "//zircon/system/ulib/storage-metrics/test:storage-metrics-bootfs-test",
    "//zircon/system/ulib/storage/buffer/test:storage_buffer-bootfs-test",
    "//zircon/system/ulib/storage/operation/test:storage_operation-bootfs-test",
    "//zircon/system/ulib/syslog/test:syslog-package",
    "//zircon/system/ulib/syslog/test:syslog-static-package",
    "//zircon/system/ulib/sysmem-make-tracking/test:sysmem-make-tracking-test-package",
    "//zircon/system/ulib/sysmem-version/test:sysmem-version-test-package",
    "//zircon/system/ulib/test-exceptions/test:test-exceptions-bootfs-test",
    "//zircon/system/ulib/test-utils/test:test-utils-bootfs-test",
    "//zircon/system/ulib/tftp/test:tftp-test-bootfs-test",
    "//zircon/system/ulib/trace-engine/test:hash-table-bootfs-test",
    "//zircon/system/ulib/trace-provider/test:trace-provider-bootfs-test",
    "//zircon/system/ulib/trace-reader/test:trace-reader-test-bootfs-test",
    "//zircon/system/ulib/trace-vthread/test:trace-vthread-test-bootfs-test",
    "//zircon/system/ulib/trace-vthread/test:trace-vthread-with-static-engine-test-bootfs-test",
    "//zircon/system/ulib/uart/test:uart-unittests-bootfs-test",
    "//zircon/system/ulib/unittest/test:unittest-bootfs-test",
    "//zircon/system/ulib/utf_conversion/test:utf_conversion-test-bootfs-test",
    "//zircon/system/ulib/zbi-bootfs/test:zbi-bootfs-test-bootfs-test",
    "//zircon/system/ulib/zbi/test:zbi-bootfs-test",
    "//zircon/system/ulib/zircon-crypto/test:zircon-crypto-bootfs-test",
    "//zircon/system/ulib/zx-panic-libc/test:zx-panic-libc-test-bootfs-test",
    "//zircon/system/ulib/zx/test:zx-bootfs-test",
    "//zircon/system/ulib/zxio/test:zxio-bootfs-test",
    "//zircon/system/ulib/zxtest/test:zxtest-bootfs-test",
    "//zircon/system/ulib/zxtest/test/integration:zxtest-integration-bootfs-test",
    "//zircon/system/utest/blobfs-bench:blobfs-bench-package",
    "//zircon/system/utest/channel-fatal:channel-fatal-bootfs-test",
    "//zircon/system/utest/cleanup:cleanup-bootfs-test",
    "//zircon/system/utest/cmdline:cmdline-bootfs-test",
    "//zircon/system/utest/compiler:compiler-bootfs-test",
    "//zircon/system/utest/core:core-c11-condvar-bootfs-test",
    "//zircon/system/utest/core:core-c11-mutex-bootfs-test",
    "//zircon/system/utest/core:core-c11-thread-bootfs-test",
    "//zircon/system/utest/core:core-channel-bootfs-test",
    "//zircon/system/utest/core:core-channel-write-etc-bootfs-test",
    "//zircon/system/utest/core:core-clock-bootfs-test",
    "//zircon/system/utest/core:core-elf-tls-bootfs-test",
    "//zircon/system/utest/core:core-event-pair-bootfs-test",
    "//zircon/system/utest/core:core-fifo-bootfs-test",
    "//zircon/system/utest/core:core-fpu-bootfs-test",
    "//zircon/system/utest/core:core-futex-bootfs-test",
    "//zircon/system/utest/core:core-handle-close-bootfs-test",
    "//zircon/system/utest/core:core-handle-dup-bootfs-test",
    "//zircon/system/utest/core:core-handle-info-bootfs-test",
    "//zircon/system/utest/core:core-handle-transfer-bootfs-test",
    "//zircon/system/utest/core:core-handle-wait-bootfs-test",
    "//zircon/system/utest/core:core-job-bootfs-test",
    "//zircon/system/utest/core:core-memory-mapping-bootfs-test",
    "//zircon/system/utest/core:core-object-child-bootfs-test",
    "//zircon/system/utest/core:core-object-info-bootfs-test",
    "//zircon/system/utest/core:core-object-wait-bootfs-test",
    "//zircon/system/utest/core:core-pager-bootfs-test",
    "//zircon/system/utest/core:core-port-bootfs-test",
    "//zircon/system/utest/core:core-process-bootfs-test",
    "//zircon/system/utest/core:core-pthread-barrier-bootfs-test",
    "//zircon/system/utest/core:core-pthread-bootfs-test",
    "//zircon/system/utest/core:core-pthread-tls-bootfs-test",
    "//zircon/system/utest/core:core-socket-bootfs-test",
    "//zircon/system/utest/core:core-stack-bootfs-test",
    "//zircon/system/utest/core:core-stream-bootfs-test",
    "//zircon/system/utest/core:core-sync-completion-bootfs-test",
    "//zircon/system/utest/core:core-sync-condition-bootfs-test",
    "//zircon/system/utest/core:core-sync-mutex-bootfs-test",
    "//zircon/system/utest/core:core-threads-bootfs-test",
    "//zircon/system/utest/core:core-time-bootfs-test",
    "//zircon/system/utest/core:core-version-bootfs-test",
    "//zircon/system/utest/core:core-vmar-bootfs-test",
    "//zircon/system/utest/core:core-vmo-bootfs-test",
    "//zircon/system/utest/core-display:core-display-bootfs-test",
    "//zircon/system/utest/cprng:cprng-bootfs-test",
    "//zircon/system/utest/ctor:ctor-bootfs-test",
    "//zircon/system/utest/debugger:debugger-bootfs-test",
    "//zircon/system/utest/device-enumeration:device-enumeration-bootfs-test",
    "//zircon/system/utest/dlfcn:dlfcn-bootfs-test",
    "//zircon/system/utest/dlopen-indirect-deps:dlopen-indirect-deps-bootfs-test",
    "//zircon/system/utest/errno:errno-bootfs-test",
    "//zircon/system/utest/exit:exit-bootfs-test",
    "//zircon/system/utest/fidl-utils:fidl-utils-bootfs-test",
    "//zircon/system/utest/fpu:fpu-bootfs-test",
    "//zircon/system/utest/fs-bench:fs-bench-bootfs-test",
    "//zircon/system/utest/fs-management:fs-management-bootfs-test",
    "//zircon/system/utest/fs-test-utils:fs-test-utils-bootfs-test",
    "//zircon/system/utest/getentropy:getentropy-bootfs-test",
    "//zircon/system/utest/inspector:inspector-bootfs-test",
    "//zircon/system/utest/int-types:int-types-bootfs-test",
    "//zircon/system/utest/kernel-unittests:kernel-unittests-bootfs-test",
    "//zircon/system/utest/log:log-bootfs-test",
    "//zircon/system/utest/logger:logger-bootfs-test",
    "//zircon/system/utest/memfs:memfs-bootfs-test",
    "//zircon/system/utest/minfs-micro-benchmark:minfs-micro-benchmark-bootfs-test",
    "//zircon/system/utest/miscsvc:miscsvc-bootfs-test",
    "//zircon/system/utest/namespace:namespace-bootfs-test",
    "//zircon/system/utest/posixio:posixio-bootfs-test",
    "//zircon/system/utest/psutils:handles-bootfs-test",
    "//zircon/system/utest/psutils:ps-bootfs-test",
    "//zircon/system/utest/pty:pty-bootfs-test",
    "//zircon/system/utest/qsort:qsort-bootfs-test",
    "//zircon/system/utest/race-tests:race-tests-bootfs-test",
    "//zircon/system/utest/runtests-utils:runtests-utils-bootfs-test",
    "//zircon/system/utest/stdio:stdio-test-package",
    "//zircon/system/utest/svchost:svchost-bootfs-test",
    "//zircon/system/utest/syscall-generation:syscall-generation-bootfs-test",
    "//zircon/system/utest/sysconf:sysconf-bootfs-test",
    "//zircon/system/utest/task-utils:task-utils-bootfs-test",
    "//zircon/system/utest/thread-safe-deleter:thread-safe-deleter-bootfs-test",
    "//zircon/system/utest/trace:trace-bootfs-test",
    "//zircon/system/utest/trace:trace-static-engine-bootfs-test",
    "//zircon/system/utest/utc-procargs:utc-procargs-bootfs-test",
    "//zircon/third_party/ulib/linenoise/test:linenoise-test-bootfs-test",
  ]

  # Tests without metadata.
  deps += [ "//src/devices/usb/drivers/usb-bus:usb-device" ]

  # The following targets contribute tests to the zbi.
  deps += [ "//build/unification/future/images:legacy_tests" ] +
          common_test_contents

  # Add various drivers and binaries used in manual testing.
  deps += [ ":manual_testing" ]
}

group("manual_testing") {
  testonly = true

  deps = [
    "//src/devices/bundles:manual_testing",
    "//src/graphics/display/bin/display-test",
    "//src/security/bin/syscall-check",
    "//src/zircon/testing/mutex_pi_exerciser",
    "//src/zircon/tests/evil",
    "//zircon/system/utest/msd",
  ]
}
